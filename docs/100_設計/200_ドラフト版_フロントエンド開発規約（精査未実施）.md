# フロントエンド開発規約（ドラフト）

本ドキュメントは、浦和北東RC公式LINE管理画面を中心に行ったリファクタリング結果を踏まえ、今後のフロントエンド開発全般に適用できる共通規約の初版ドラフトです。現時点で利用可能なレベルで、可読性・保守性・バグやデグレの防止を目的とします。

---

## 1. 基本原則

- **SSOT（Single Source of Truth）**：状態は State オブジェクトで一元管理し、DOM は入出力に限定する。
- **疎結合**：UIとビジネスロジックを分離し、再利用可能性を高める。
- **早期バリデーション**：送信前に入力を必ず検証し、エラーは一覧表示する。
- **Fail-safe**：異常時は安全側に倒す（例: 無効化、送信抑止）。

---

## 2. 命名・構成

- DOMのIDは `kebab-case`、JS変数・関数は `camelCase`。
- 関数命名ルール：
  - `handleXxx` = イベントハンドラ
  - `renderXxx` = 描画
  - `resolveXxx` = 非同期解決
- 定数（DOM要素のIDなど）は `EL` に集約する。
- ファイル構成は責務単位で分割（例：state.js, dom.js, api.js, validate.js）。

---

## 3. コーディング規約

### 状態管理
- Stateオブジェクトに全入力値・選択値を集約。
- UI表示時：State → DOM、入力時：DOM → State、送信時：State → API。

### 非同期制御
- `isSubmitting` などのフラグで送信中状態を管理。
- 送信中はボタンを `disabled`、解除は必ず `finally` で。

### バリデーション
- `validateXxx(state)` を送信直前に呼ぶ。
- エラーは配列で収集し、まとめてUIに表示。

### DOMアクセス
- `document.getElementById()` のIDは定数 EL に集約。
- 外部入力は `innerHTML` で代入しない。`textContent` を原則とする。

### 日付・時刻
- JST(+09:00) ISO8601 に正規化する共通関数を利用。
- 業務ルール（例: 締切=当日23:59:59）は関数化して再利用。

### 画像・ファイル
- アップロード前に拡張子・サイズをUIで検証。
- プレビューは `URL.createObjectURL` を使用し、不要時は `revokeObjectURL`。

### 通知・ログ
- UI通知は `toast.success|error|info` に統一。
- デバッグログは `console.debug('[feature]', {...})` 形式で出す。

---

## 4. ツール設定

- ESLint + Prettier を必須とし、ルールは最小限に統一。
- 推奨ルール例：
  - セミコロン必須
  - 単一引用符
  - `eqeqeq`
  - `no-inner-html` 独自ルール
- 将来的に TypeScript 導入を検討（型の揺れ防止）。

---

## 5. PR/レビュー基準

- 変更は責務単位で行う。
- テスト観点チェックリストを PR に添付。
- 画面変更を伴う場合はスクリーンショットを添付。

---

## 6. テスト／リリース

- 手動テストは基本パターンとエッジケースをカバーするチェックリスト形式。
- リリース時はキャッシュ対策（バージョン付与、ハードリロード案内）を含める。

---

## 7. 今後の拡張候補

- 命名規則・ディレクトリ構成の更なる具体化。
- エラー分類（UserError/SystemError）とUIの扱い分け。
- アクセシビリティ対応（label for、aria-*、エラー時フォーカス移動）。
- 文言辞書化（i18n対応を見据える）。
- セキュリティ規約（XSS禁止、CSP、CSRF対応）。

---

## まとめ

この規約は、現在のバニラJS環境で直ちに利用可能な最低限かつ実用的なルールセットです。まずは既存機能（イベント作成、メンバー管理、配信グループ管理）に適用し、フィードバックを踏まえて改訂していきます。
