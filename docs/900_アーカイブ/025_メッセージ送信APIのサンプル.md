イベント作成で公式LINEへのメッセージ送信を行うため、APIの文法のサンプルとなるものを探したい。

# Perplexityへの質問文（日本語）
  LINE Messaging API Flex Message 公式サンプル GitHub リポジトリを探しています。

  以下の条件に合うものを教えてください：
  1. LINE公式またはLINE Developersが提供しているGitHubリポジトリ
  2. Flex Messageのサンプルコードが含まれている
  3. Node.js/JavaScriptでの実装例がある
  4. 特に画像付きのFlex Message（hero imageを含むbubble type）のサンプル
  5. multicast APIを使った送信例があるとなお良い

  具体的には以下のようなエラーを解決したい：
  - "invalid uri scheme" エラー（hero/url）
  - Flex Messageの正しいJSON構造

  GitHubのリポジトリURLと、特に参考になるファイルパスを教えてください。

  または、より詳細な検索用：

  GitHub site:github.com "line-bot-sdk" OR "line/line-bot-sdk-nodejs" Flex Message example hero image bubble

  特に以下の情報が必要：
  - LINE公式のbot-sdk-nodejsリポジトリ
  - Flex Message Simulatorのサンプル
  - line-bot-sdk-nodejs/examples ディレクトリ
  - Flex Messageのvalidationルール
  - 画像URLの正しい形式（httpsスキーム必須など）

# Perplexityによる回答
LINE公式の「line-bot-sdk-nodejs」リポジトリには、**Node.js/JavaScript対応のFlex MessageやマルチキャストAPIの実装例、画像付きバブル（hero image）サンプル**が含まれています。[1]

## GitHubリポジトリと参考ファイルパス

- **リポジトリURL**  
  https://github.com/line/line-bot-sdk-nodejs  
  公式のNode.js SDKで、examplesディレクトリにサンプルコードがまとまっています。[1]

- **Flex Messageサンプル**  
  GitHubの「examples」ディレクトリ配下にFlex Messageのサンプルがあります（ただしGitHub上のUIまたはローカルクローンで `examples/` を参照してください）。[1]

  例：
  ```
`
line-bot-sdk-nodejs/examples/send-flex-message.js
line-bot-sdk-nodejs/examples/multicast.js
```
  ```

- **Hero imageつきバブル例**  
  Flex Messageの`hero`ブロック付きバブル例は、LINE Developers公式ドキュメントやSimulatorが最も正しいJSON例を示しています[6][7]。

## Flex MessageのJSON構造とバリデーション

- **Flex Message JSONの正しい構造**
  - typeは "flex"
  - contentsに"bubble"オブジェクト
  - hero/urlは`https://`スキーム（http不可、data不可）

  例:
  ```
  {
    "type": "flex",
    "altText": "This is a Flex Message",
    "contents": {
      "type": "bubble",
      "hero": {
        "type": "image",
        "url": "https://example.com/image.jpg",
        "size": "full",
        "aspectRatio": "20:13"
      },
      "body": {
        "type": "box",
        "layout": "vertical",
        "contents": [
          {
            "type": "text",
            "text": "body content"
          }
        ]
      }
    }
  }
  ```
  - **「invalid uri scheme」エラー回避**：`url`は必ず`https`で始める必要があります[6]。

- **Flex Messageバリデーション**
  - 公式SimulatorとJSONLintなどで検証可能[7]。
  - 「contents」下のJSONのみ取得して挿入する点に注意。

## マルチキャストAPIの例

- **multicast API使用例**
  - `client.multicast(to, messages)` 形式で複数ユーザーに送信可能
  - Flex messageも同様に`messages`配列で渡せます[9]。

## 公式Simulator・検証

- Flex Message Simulator:  
  [LINE Flex Message Simulator （LINE公式ツール、ドキュメントより）](https://developers.line.biz/flex-simulator/)
- サンプルJSONはSimulatorから取得し、そのままAPI用に使う際は「contents」部分をペイロードに挿入する[7]。

---

### まとめ

| 要素                           | 参考リソース                                                                                         |
|-------------------------------|------------------------------------------------------------------------------------------------------|
| Node.js公式SDK                | https://github.com/line/line-bot-sdk-nodejs                                                          |
| Examplesサンプルパス           | `examples/send-flex-message.js`, `examples/multicast.js` ほか                                        |
| Flex Message仕様/バリデーション | https://developers.line.biz/ja/docs/messaging-api/using-flex-messages/ <br> Flex Simulatorサイト     |
| Hero imageのurl正規例           | httpsで始まる画像URLを指定（http, dataは不可）                                                      |
| Flex Message Simulator         | https://developers.line.biz/flex-simulator/                                                         |

- これらを参考に、hero imageのurl形式（https必須）、およびエラーメッセージ解決やバブルの正しい構造などが確認できます[1][6][7][9]。

[1](https://github.com/line/line-bot-sdk-nodejs)
[2](https://github.com/line/line-bot-sdk-nodejs/releases)
[3](https://line.github.io/line-bot-sdk-nodejs/getting-started/basic-usage.html)
[4](https://line.github.io/line-bot-sdk-nodejs/getting-started/install.html)
[5](https://qiita.com/GorillaSwe/items/fb261d07643e678bc6ff)
[6](https://qiita.com/daitasu/items/4a560818aaeb171f5362)
[7](https://knowledge.littlehelp.co.jp/chatbot/message/flex-message)
[8](https://qiita.com/nozomiyamada/items/4ac398159cdcf2f92056)
[9](https://qiita.com/ufoo68/items/ea923025e7989ff5af3d)
[10](https://zenn.dev/nbstsh/scraps/5768448b6a378a)